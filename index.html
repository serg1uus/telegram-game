<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–≥—Ä–∞ Alias - Telegram Mini App</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body class="bg-gradient-to-br from-orange-500 to-red-600 min-h-screen text-white">
    <div class="container mx-auto px-4 py-6 max-w-md">
        <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω -->
        <div id="mainScreen" class="screen">
            <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 shadow-2xl border border-white/20">
                <div class="text-center mb-8">
                    <div class="text-6xl mb-4 drop-shadow-md">üó£Ô∏è</div>
                    <h1 class="text-4xl font-extrabold mb-2 tracking-tight">ALIAS</h1>
                    <p class="text-white/90 font-medium">–°–∫–∞–∂–∏ –∏–Ω–∞—á–µ!</p>
                </div>
                
                <div class="space-y-4">
                    <button onclick="startNewGame()" class="w-full bg-white text-orange-600 py-4 px-6 rounded-xl font-bold text-lg hover:bg-white/90 transition-all transform hover:scale-105 shadow-lg">
                        üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞
                    </button>
                    <button onclick="showRules()" class="w-full bg-black/20 py-4 px-6 rounded-xl font-semibold text-lg hover:bg-black/30 transition-all border border-white/10">
                        üìñ –ü—Ä–∞–≤–∏–ª–∞
                    </button>
                    <button onclick="showCategories()" class="w-full bg-black/20 py-4 px-6 rounded-xl font-semibold text-lg hover:bg-black/30 transition-all border border-white/10">
                        üìù –°–ª–æ–≤–∞—Ä–∏
                    </button>
                </div>
                
                <div class="mt-8 text-center text-white/70 text-sm">
                    <p>–î–æ—Å—Ç—É–ø–Ω–æ —Å–ª–æ–≤: <span id="totalWords" class="font-bold">0</span></p>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –ø—Ä–∞–≤–∏–ª -->
        <div id="rulesScreen" class="screen hidden">
            <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 shadow-2xl border border-white/20">
                <h2 class="text-2xl font-bold mb-4 flex items-center">üìñ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å –≤ Alias</h2>
                <div class="space-y-3 text-white/95 text-base">
                    <p>üéØ <strong>–°—É—Ç—å:</strong> –û–±—ä—è—Å–Ω–∏ –Ω–∞–ø–∞—Ä–Ω–∏–∫—É —Å–ª–æ–≤–æ —Å –∫–∞—Ä—Ç–æ—á–∫–∏, –Ω–µ –Ω–∞–∑—ã–≤–∞—è –µ–≥–æ.</p>
                    <p>‚è±Ô∏è <strong>–¢–∞–π–º–µ—Ä:</strong> –£—Å–ø–µ–π –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –∑–∞ 60 —Å–µ–∫—É–Ω–¥.</p>
                    <div class="bg-red-500/20 p-3 rounded-lg border border-red-400/30">
                        <p class="font-bold text-red-100">üö´ –ó–∞–ø—Ä–µ—â–µ–Ω–æ:</p>
                        <ul class="list-disc list-inside text-sm mt-1 opacity-90">
                            <li>–û–¥–Ω–æ–∫–æ—Ä–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞</li>
                            <li>–ü–µ—Ä–µ–≤–æ–¥ —Å –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–æ–≤</li>
                            <li>–ñ–µ—Å—Ç—ã</li>
                        </ul>
                    </div>
                    <div class="bg-green-500/20 p-3 rounded-lg border border-green-400/30">
                        <p class="font-bold text-green-100">‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–æ:</p>
                        <ul class="list-disc list-inside text-sm mt-1 opacity-90">
                            <li>–°–∏–Ω–æ–Ω–∏–º—ã –∏ –∞–Ω—Ç–æ–Ω–∏–º—ã</li>
                            <li>–û–ø–∏—Å–∞–Ω–∏—è —Å–∏—Ç—É–∞—Ü–∏–π</li>
                            <li>–ó–≤—É–∫–∏ –∏ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏</li>
                        </ul>
                    </div>
                </div>
                <button onclick="showMain()" class="w-full mt-6 bg-white/20 py-3 px-6 rounded-xl font-semibold hover:bg-white/30 transition-all">
                    ‚Üê –í –º–µ–Ω—é
                </button>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
        <div id="categoriesScreen" class="screen hidden">
            <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 shadow-2xl border border-white/20">
                <h2 class="text-2xl font-bold mb-4">üìù –ù–∞–±–æ—Ä—ã —Å–ª–æ–≤</h2>
                <div id="categoryList" class="space-y-2 mb-6 max-h-[60vh] overflow-y-auto">
                    <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
                <div class="space-y-3">
                    <button onclick="saveCategories()" class="w-full bg-green-500 text-white py-3 px-6 rounded-xl font-bold hover:bg-green-600 transition-all shadow-lg">
                        ‚úì –ü—Ä–∏–º–µ–Ω–∏—Ç—å
                    </button>
                    <button onclick="showMain()" class="w-full bg-white/20 py-3 px-6 rounded-xl font-semibold hover:bg-white/30 transition-all">
                        ‚Üê –û—Ç–º–µ–Ω–∞
                    </button>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã -->
        <div id="setupScreen" class="screen hidden">
            <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 shadow-2xl border border-white/20">
                <h2 class="text-2xl font-bold mb-6">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—É–Ω–¥–∞</h2>
                
                <div class="space-y-6">
                    <div>
                        <label class="block text-white/90 font-semibold mb-2">‚è±Ô∏è –í—Ä–µ–º—è —Ä–∞—É–Ω–¥–∞</label>
                        <select id="roundTime" class="w-full bg-black/20 border border-white/20 p-3 rounded-xl text-white outline-none focus:border-white/50 transition-all">
                            <option value="30">30 —Å–µ–∫—É–Ω–¥ (–ë–ª–∏—Ü)</option>
                            <option value="60" selected>60 —Å–µ–∫—É–Ω–¥ (–°—Ç–∞–Ω–¥–∞—Ä—Ç)</option>
                            <option value="90">90 —Å–µ–∫—É–Ω–¥ (–†–∞—Å—Å–ª–∞–±–ª–µ–Ω–Ω–æ)</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-white/90 font-semibold mb-2">üå∂Ô∏è –°–ª–æ–∂–Ω–æ—Å—Ç—å —Å–ª–æ–≤</label>
                        <select id="difficulty" class="w-full bg-black/20 border border-white/20 p-3 rounded-xl text-white outline-none focus:border-white/50 transition-all">
                            <option value="easy">–ù–æ–≤–∏—á–æ–∫ (–õ–µ–≥–∫–∏–µ —Å–ª–æ–≤–∞)</option>
                            <option value="medium" selected>–õ—é–±–∏—Ç–µ–ª—å (–ù–æ—Ä–º–∞–ª—å–Ω–æ)</option>
                            <option value="hard">–ü—Ä–æ—Ñ–∏ (–°–ª–æ–∂–Ω–æ)</option>
                            <option value="mixed">–°–ª—É—á–∞–π–Ω–∞—è —Å–º–µ—Å—å</option>
                        </select>
                    </div>
                </div>
                
                <div class="mt-8 space-y-3">
                    <button onclick="startGame()" class="w-full bg-white text-orange-600 py-4 px-6 rounded-xl font-bold text-xl hover:bg-gray-100 transition-all transform hover:scale-105 shadow-lg">
                        üöÄ –ü–û–ï–•–ê–õ–ò!
                    </button>
                    <button onclick="showMain()" class="w-full bg-black/20 py-3 px-6 rounded-xl font-semibold hover:bg-black/30 transition-all">
                        ‚Üê –ù–∞–∑–∞–¥
                    </button>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∏–≥—Ä—ã -->
        <div id="gameScreen" class="screen hidden">
            <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 shadow-2xl border border-white/20">
                <!-- –¢–∞–π–º–µ—Ä –∏ —Å—á–µ—Ç -->
                <div class="flex justify-between items-center mb-6 bg-black/10 rounded-xl p-3">
                    <div class="text-center w-1/2 border-r border-white/10">
                        <p class="text-white/60 text-xs uppercase tracking-wider">–í—Ä–µ–º—è</p>
                        <p class="text-3xl font-mono font-bold tabular-nums" id="timer">60</p>
                    </div>
                    <div class="text-center w-1/2">
                        <p class="text-white/60 text-xs uppercase tracking-wider">–û—á–∫–∏</p>
                        <p class="text-3xl font-mono font-bold tabular-nums" id="score">0</p>
                    </div>
                </div>
                
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Å–æ —Å–ª–æ–≤–æ–º -->
                <div class="bg-white text-gray-900 rounded-2xl p-8 mb-6 min-h-[220px] flex flex-col items-center justify-center shadow-xl relative overflow-hidden transition-all duration-300" id="cardArea">
                    <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-orange-400 to-red-500"></div>
                    <div class="text-center z-10">
                        <span class="inline-block px-3 py-1 bg-gray-100 text-gray-500 rounded-full text-xs font-bold mb-3 uppercase tracking-wide" id="wordCategory">
                            –ö–∞—Ç–µ–≥–æ—Ä–∏—è
                        </span>
                        <h3 class="text-4xl md:text-5xl font-black mb-2 break-words leading-tight" id="currentWord">Alias</h3>
                    </div>
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
                <div id="gameControls" class="space-y-3">
                    <button onclick="toggleGame()" id="startBtn" class="w-full bg-white text-orange-600 py-4 px-6 rounded-xl font-bold text-xl hover:bg-gray-50 transition-all shadow-lg">
                        ‚ñ∂Ô∏è –°—Ç–∞—Ä—Ç
                    </button>
                    <div id="actionButtons" class="hidden grid grid-cols-2 gap-3">
                        <button onclick="skipWord()" class="bg-red-500 py-6 px-4 rounded-xl font-bold text-white hover:bg-red-600 active:bg-red-700 transition-all shadow-lg flex flex-col items-center">
                            <span class="text-2xl mb-1">‚è≠Ô∏è</span>
                            <span class="text-sm opacity-90">–ü—Ä–æ–ø—É—Å–∫ (-1)</span>
                        </button>
                        <button onclick="guessWord()" class="bg-green-500 py-6 px-4 rounded-xl font-bold text-white hover:bg-green-600 active:bg-green-700 transition-all shadow-lg flex flex-col items-center">
                            <span class="text-2xl mb-1">‚úÖ</span>
                            <span class="text-sm opacity-90">–£–≥–∞–¥–∞–ª (+1)</span>
                        </button>
                    </div>
                    <button onclick="endGame()" class="w-full bg-black/20 py-2 px-6 rounded-lg text-sm font-semibold hover:bg-black/30 transition-all opacity-60 hover:opacity-100 mt-4">
                        üèÅ –ó–∞–≤–µ—Ä—à–∏—Ç—å –¥–æ—Å—Ä–æ—á–Ω–æ
                    </button>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
        <div id="resultsScreen" class="screen hidden">
            <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 shadow-2xl border border-white/20">
                <div class="text-center mb-6">
                    <div class="text-6xl mb-4 animate-bounce">üèÜ</div>
                    <h2 class="text-3xl font-bold mb-1">–†–∞—É–Ω–¥ –∑–∞–≤–µ—Ä—à–µ–Ω!</h2>
                    <p class="text-white/60">–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!</p>
                </div>
                
                <div class="bg-white/10 rounded-xl p-6 mb-6 border border-white/10">
                    <div class="grid grid-cols-3 gap-4 text-center divide-x divide-white/10">
                        <div>
                            <p class="text-white/60 text-xs mb-1">–ò–¢–û–ì</p>
                            <p class="text-4xl font-bold" id="finalScore">0</p>
                        </div>
                        <div>
                            <p class="text-green-300 text-xs mb-1">–í–ï–†–ù–û</p>
                            <p class="text-2xl font-bold text-green-400" id="guessedWords">0</p>
                        </div>
                        <div>
                            <p class="text-red-300 text-xs mb-1">–ü–†–û–ü–£–°–ö</p>
                            <p class="text-2xl font-bold text-red-400" id="skippedWords">0</p>
                        </div>
                    </div>
                </div>
                
                <div class="space-y-3">
                    <button onclick="shareResults()" class="w-full bg-blue-500 py-3 px-6 rounded-xl font-bold hover:bg-blue-600 transition-all shadow-lg flex items-center justify-center gap-2">
                        üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—á–µ—Ç–æ–º
                    </button>
                    <button onclick="startNewGame()" class="w-full bg-white text-orange-600 py-3 px-6 rounded-xl font-bold hover:bg-gray-100 transition-all shadow-lg">
                        üîÑ –°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥
                    </button>
                    <button onclick="showMain()" class="w-full bg-black/20 py-3 px-6 rounded-xl font-semibold hover:bg-black/30 transition-all">
                        üè† –í –º–µ–Ω—é
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        const tg = window.Telegram?.WebApp;
        if (tg) {
            tg.ready();
            try {
                tg.expand();
                tg.setHeaderColor('#ea580c'); // –¶–≤–µ—Ç —à–∞–ø–∫–∏ (orange-600)
            } catch(e) {}
        }

        // –ë–∞–∑–∞ —Å–ª–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (–û—Å—Ç–∞–≤–∏–ª–∏ —Ç–µ –∂–µ —Å–ª–æ–≤–∞, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è Alias)
        const wordsDatabase = {
            animals: {
                name: "üêæ –ñ–∏–≤–æ—Ç–Ω—ã–π –º–∏—Ä",
                easy: ["–ö–æ—Ç", "–°–æ–±–∞–∫–∞", "–°–ª–æ–Ω", "–ñ–∏—Ä–∞—Ñ", "–õ–µ–≤", "–¢–∏–≥—Ä", "–ú–µ–¥–≤–µ–¥—å", "–í–æ–ª–∫", "–ó–∞—è—Ü", "–õ–∏—Å–∞"],
                medium: ["–ù–æ—Å–æ—Ä–æ–≥", "–ë–µ–≥–µ–º–æ—Ç", "–ü–∞–Ω—Ç–µ—Ä–∞", "–ì–µ–ø–∞—Ä–¥", "–ê–Ω—Ç–∏–ª–æ–ø–∞", "–ó–µ–±—Ä–∞", "–ö–µ–Ω–≥—É—Ä—É", "–ö–æ–∞–ª–∞", "–ü–∞–Ω–¥–∞", "–û—Ä–∞–Ω–≥—É—Ç–∞–Ω"],
                hard: ["–ö–∞–ø–∏–±–∞—Ä–∞", "–û–∫–∞–ø–∏", "–¢–∞–ø–∏—Ä", "–í–æ–º–±–∞—Ç", "–ï—Ö–∏–¥–Ω–∞", "–£—Ç–∫–æ–Ω–æ—Å", "–õ–µ–º—É—Ä", "–°—É—Ä–∏–∫–∞—Ç", "–ë—Ä–æ–Ω–µ–Ω–æ—Å–µ—Ü", "–ú—É—Ä–∞–≤—å–µ–¥"]
            },
            food: {
                name: "üçï –ï–¥–∞ –∏ –ö—É—Ö–Ω—è",
                easy: ["–•–ª–µ–±", "–ú–æ–ª–æ–∫–æ", "–Ø–π—Ü–æ", "–°—ã—Ä", "–ú–∞—Å–ª–æ", "–°—É–ø", "–ö–∞—à–∞", "–°–∞–ª–∞—Ç", "–ü–∏—Ü—Ü–∞", "–¢–æ—Ä—Ç"],
                medium: ["–õ–∞–∑–∞–Ω—å—è", "–ü–∞—ç–ª—å—è", "–†–∏–∑–æ—Ç—Ç–æ", "–¢–∏—Ä–∞–º–∏—Å—É", "–ö—Ä—É–∞—Å—Å–∞–Ω", "–§–æ–Ω–¥—é", "–ì—É–ª—è—à", "–†–∞—Ç–∞—Ç—É–π", "–ö–∞—Ä–ø–∞—á—á–æ", "–ë—Ä—É—Å–∫–µ—Ç—Ç–∞"],
                hard: ["–§—É–∞-–≥—Ä–∞", "–ö–æ–Ω—Ñ–∏", "–ë–ª–∞–Ω–º–∞–Ω–∂–µ", "–ö—Ä–µ–º–±—Ä—é–ª–µ", "–ü—Ä–æ—Ñ–∏—Ç—Ä–æ–ª–∏", "–ö–∏—à", "–¢–∞—Ä—Ç–∞—Ä", "–°–µ–≤–∏—á–µ", "–¢–µ–º–ø—É—Ä–∞", "–ú–∏—Å–æ"]
            },
            professions: {
                name: "üëî –ü—Ä–æ—Ñ–µ—Å—Å–∏–∏",
                easy: ["–í—Ä–∞—á", "–£—á–∏—Ç–µ–ª—å", "–ü–æ–≤–∞—Ä", "–í–æ–¥–∏—Ç–µ–ª—å", "–ü—Ä–æ–¥–∞–≤–µ—Ü", "–ü–æ–ª–∏—Ü–µ–π—Å–∫–∏–π", "–ü–æ–∂–∞—Ä–Ω—ã–π", "–°—Ç—Ä–æ–∏—Ç–µ–ª—å", "–•—É–¥–æ–∂–Ω–∏–∫", "–ü–µ–≤–µ—Ü"],
                medium: ["–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä", "–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç", "–ü—Å–∏—Ö–æ–ª–æ–≥", "–ë—É—Ö–≥–∞–ª—Ç–µ—Ä", "–î–∏–∑–∞–π–Ω–µ—Ä", "–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç", "–§–æ—Ç–æ–≥—Ä–∞—Ñ", "–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫", "–Æ—Ä–∏—Å—Ç", "–≠–∫–æ–Ω–æ–º–∏—Å—Ç"],
                hard: ["–°–æ–º–µ–ª—å–µ", "–ö–∏–Ω–æ–ª–æ–≥", "–û—Ä–Ω–∏—Ç–æ–ª–æ–≥", "–ì–µ–º–º–æ–ª–æ–≥", "–≠—Ç–Ω–æ–≥—Ä–∞—Ñ", "–ü–∞–ª–µ–æ–Ω—Ç–æ–ª–æ–≥", "–ö—Ä–∏–º–∏–Ω–∞–ª–∏—Å—Ç", "–õ–æ–≥–∏—Å—Ç", "–ö–æ–ø–∏—Ä–∞–π—Ç–µ—Ä", "–¢–∞—Ä–≥–µ—Ç–æ–ª–æ–≥"]
            },
            movies: {
                name: "üé¨ –ö–∏–Ω–æ –∏ –¢–í",
                easy: ["–¢–∏—Ç–∞–Ω–∏–∫", "–ê–≤–∞—Ç–∞—Ä", "–ú–∞—Ç—Ä–∏—Ü–∞", "–¢–µ—Ä–º–∏–Ω–∞—Ç–æ—Ä", "–ì–ª–∞–¥–∏–∞—Ç–æ—Ä", "–õ–µ–æ–Ω", "–§–æ—Ä—Å–∞–∂", "–¢–∞–∫—Å–∏", "–ú–∞—Å–∫–∞", "–û–¥–∏–Ω –¥–æ–º–∞"],
                medium: ["–ù–∞—á–∞–ª–æ", "–ò–Ω—Ç–µ—Ä—Å—Ç–µ–ª–ª–∞—Ä", "–ü—Ä–µ—Å—Ç–∏–∂", "–ë–æ–π—Ü–æ–≤—Å–∫–∏–π –∫–ª—É–±", "–ö—Ä–∏–º–∏–Ω–∞–ª—å–Ω–æ–µ —á—Ç–∏–≤–æ", "–ó–µ–ª–µ–Ω–∞—è –º–∏–ª—è", "–ü–æ–±–µ–≥ –∏–∑ –®–æ—É—à–µ–Ω–∫–∞", "–ö—Ä–µ—Å—Ç–Ω—ã–π –æ—Ç–µ—Ü", "–§–æ—Ä—Ä–µ—Å—Ç –ì–∞–º–ø", "–ù–∞–∑–∞–¥ –≤ –±—É–¥—É—â–µ–µ"],
                hard: ["–ú–µ–º–µ–Ω—Ç–æ", "–ú–∞–ª—Ö–æ–ª–ª–∞–Ω–¥ –î—Ä–∞–π–≤", "–î–æ–Ω–Ω–∏ –î–∞—Ä–∫–æ", "–í–µ—á–Ω–æ–µ —Å–∏—è–Ω–∏–µ —á–∏—Å—Ç–æ–≥–æ —Ä–∞–∑—É–º–∞", "–†–µ–∫–≤–∏–µ–º –ø–æ –º–µ—á—Ç–µ", "–ë–µ—Ä–¥–º—ç–Ω", "–õ–æ–±—Å—Ç–µ—Ä", "–î–æ–≥–≤–∏–ª–ª—å", "–°–æ–ª—è—Ä–∏—Å", "–°—Ç–∞–ª–∫–µ—Ä"]
            },
            tech: {
                name: "üíª IT –∏ –ì–∞–¥–∂–µ—Ç—ã",
                easy: ["–ö–æ–º–ø—å—é—Ç–µ—Ä", "–¢–µ–ª–µ—Ñ–æ–Ω", "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç", "–ü—Ä–∏–Ω—Ç–µ—Ä", "–ú–æ–Ω–∏—Ç–æ—Ä", "–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞", "–ú—ã—à—å", "–ù–∞—É—à–Ω–∏–∫–∏", "–ö–∞–º–µ—Ä–∞", "–†–æ–±–æ—Ç"],
                medium: ["–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä", "–í–∏–¥–µ–æ–∫–∞—Ä—Ç–∞", "–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å", "–ñ–µ—Å—Ç–∫–∏–π –¥–∏—Å–∫", "–†–æ—É—Ç–µ—Ä", "–°–µ—Ä–≤–µ—Ä", "–î—Ä–æ–Ω", "–°–º–∞—Ä—Ç—á–∞—Å—ã", "–ü–ª–∞–Ω—à–µ—Ç", "Powerbank"],
                hard: ["–ë–ª–æ–∫—á–µ–π–Ω", "–ù–µ–π—Ä–æ—Å–µ—Ç—å", "–ö–≤–∞–Ω—Ç–æ–≤—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä", "–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞", "–¢–æ–∫–µ–Ω", "API", "–§—Ä–µ–π–º–≤–æ—Ä–∫", "–ê–ª–≥–æ—Ä–∏—Ç–º", "–ö–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "–î–∞—Ç–∞—Ü–µ–Ω—Ç—Ä"]
            },
            sports: {
                name: "‚öΩ –°–ø–æ—Ä—Ç",
                easy: ["–§—É—Ç–±–æ–ª", "–ë–∞—Å–∫–µ—Ç–±–æ–ª", "–¢–µ–Ω–Ω–∏—Å", "–•–æ–∫–∫–µ–π", "–ë–æ–∫—Å", "–ü–ª–∞–≤–∞–Ω–∏–µ", "–ë–µ–≥", "–í–æ–ª–µ–π–±–æ–ª", "–ì–æ–ª—å—Ñ", "–®–∞—Ö–º–∞—Ç—ã"],
                medium: ["–ë–∏–∞—Ç–ª–æ–Ω", "–†–µ–≥–±–∏", "–ë–∞–¥–º–∏–Ω—Ç–æ–Ω", "–§–µ—Ö—Ç–æ–≤–∞–Ω–∏–µ", "–ì–∞–Ω–¥–±–æ–ª", "–í–æ–¥–Ω–æ–µ –ø–æ–ª–æ", "–ö–µ—Ä–ª–∏–Ω–≥", "–°–∫–≤–æ—à", "–ö—Ä–∏–∫–µ—Ç", "–ë–µ–π—Å–±–æ–ª"],
                hard: ["–ü–µ—Ç–∞–Ω–∫", "–õ–∞–∫—Ä–æ—Å—Å", "–ü–æ–ª–æ", "–ö—Ä–æ–∫–µ—Ç", "–ë–æ–±—Å–ª–µ–π", "–°–∫–µ–ª–µ—Ç–æ–Ω", "–ö–∞–π—Ç—Å–µ—Ä—Ñ–∏–Ω–≥", "–ü–∞—Ä–∫—É—Ä", "–°–ª—ç–∫–ª–∞–π–Ω", "–§–ª–æ—Ä–±–æ–ª"]
            }
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let gameState = {
            currentWords: [],
            currentWordIndex: 0,
            score: 0,
            guessed: 0,
            skipped: 0,
            timeLeft: 60,
            isPlaying: false,
            timer: null,
            selectedCategories: ['animals', 'food', 'professions', 'movies'],
            difficulty: 'medium',
            roundTime: 60
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            updateTotalWords();
            initCategories();
        });

        // –§—É–Ω–∫—Ü–∏–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
        }

        function showMain() {
            showScreen('mainScreen');
        }

        function showRules() {
            showScreen('rulesScreen');
        }

        function showCategories() {
            showScreen('categoriesScreen');
        }

        function startNewGame() {
            showScreen('setupScreen');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        function initCategories() {
            const categoryList = document.getElementById('categoryList');
            categoryList.innerHTML = '';
            
            Object.entries(wordsDatabase).forEach(([key, category]) => {
                const isChecked = gameState.selectedCategories.includes(key);
                const div = document.createElement('div');
                div.className = 'flex items-center p-4 bg-black/20 rounded-xl hover:bg-black/30 transition-all cursor-pointer border border-white/5';
                div.innerHTML = `
                    <div class="relative flex items-center justify-center">
                        <input type="checkbox" id="cat-${key}" value="${key}" 
                               class="peer appearance-none w-6 h-6 border-2 border-white/50 rounded-md checked:bg-green-500 checked:border-green-500 transition-colors">
                        <span class="absolute text-white opacity-0 peer-checked:opacity-100 text-sm font-bold">‚úì</span>
                    </div>
                    <label for="cat-${key}" class="flex-1 cursor-pointer ml-3">
                        <span class="text-lg font-semibold block">${category.name}</span>
                        <span class="text-xs text-white/60">
                            ${category.easy.length + category.medium.length + category.hard.length} —Å–ª–æ–≤
                        </span>
                    </label>
                `;
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –≤–µ—Å—å –±–ª–æ–∫
                div.addEventListener('click', (e) => {
                    if (e.target.type !== 'checkbox') {
                        const checkbox = div.querySelector('input');
                        checkbox.checked = !checkbox.checked;
                    }
                });
                
                // –ü—Ä–æ—Å—Ç–∞–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–∞
                const checkbox = div.querySelector('input');
                checkbox.checked = isChecked;

                categoryList.appendChild(div);
            });
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        function saveCategories() {
            const checkboxes = document.querySelectorAll('#categoryList input[type="checkbox"]:checked');
            gameState.selectedCategories = Array.from(checkboxes).map(cb => cb.value);
            
            if (gameState.selectedCategories.length === 0) {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π alert —Ç–µ–ª–µ–≥—Ä–∞–º–∞
                if(tg) tg.showAlert('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é!');
                else alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é!');
                return;
            }
            
            updateTotalWords();
            showMain();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ —Å–ª–æ–≤
        function updateTotalWords() {
            let total = 0;
            gameState.selectedCategories.forEach(cat => {
                if (wordsDatabase[cat]) {
                    const category = wordsDatabase[cat];
                    total += category.easy.length + category.medium.length + category.hard.length;
                }
            });
            document.getElementById('totalWords').textContent = total;
        }

        // –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã
        function startGame() {
            gameState.roundTime = parseInt(document.getElementById('roundTime').value);
            gameState.difficulty = document.getElementById('difficulty').value;
            gameState.timeLeft = gameState.roundTime;
            gameState.score = 0;
            gameState.guessed = 0;
            gameState.skipped = 0;
            gameState.currentWordIndex = 0;
            
            // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–ª–æ–≤
            prepareWords();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            document.getElementById('timer').textContent = gameState.timeLeft;
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('currentWord').textContent = '–ì–æ—Ç–æ–≤?';
            document.getElementById('wordCategory').textContent = '–ù–∞–∂–º–∏ –°—Ç–∞—Ä—Ç';
            document.getElementById('startBtn').textContent = '‚ñ∂Ô∏è –°—Ç–∞—Ä—Ç';
            document.getElementById('actionButtons').classList.add('hidden');
            
            showScreen('gameScreen');
        }

        // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–ø–∏—Å–∫–∞ —Å–ª–æ–≤
        function prepareWords() {
            gameState.currentWords = [];
            
            gameState.selectedCategories.forEach(catKey => {
                const category = wordsDatabase[catKey];
                if (!category) return;
                
                let words = [];
                if (gameState.difficulty === 'easy') {
                    words = category.easy;
                } else if (gameState.difficulty === 'medium') {
                    words = category.medium;
                } else if (gameState.difficulty === 'hard') {
                    words = category.hard;
                } else { // mixed
                    words = [...category.easy, ...category.medium, ...category.hard];
                }
                
                words.forEach(word => {
                    gameState.currentWords.push({
                        word: word,
                        category: category.name
                    });
                });
            });
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ —Å–ª–æ–≤
            gameState.currentWords = shuffleArray(gameState.currentWords);
        }

        // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–π
        function toggleGame() {
            if (!gameState.isPlaying) {
                startRound();
            } else {
                pauseRound();
            }
        }

        function startRound() {
            gameState.isPlaying = true;
            document.getElementById('startBtn').textContent = '‚è∏Ô∏è –ü–∞—É–∑–∞';
            document.getElementById('actionButtons').classList.remove('hidden');
            
            // –ï—Å–ª–∏ –∏–≥—Ä–∞ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª–∞—Å—å (–ø–µ—Ä–≤–æ–µ —Å–ª–æ–≤–æ)
            if (document.getElementById('currentWord').textContent === '–ì–æ—Ç–æ–≤?') {
                 showNextWord();
            }
            
            startTimer();
        }

        function pauseRound() {
            gameState.isPlaying = false;
            document.getElementById('startBtn').textContent = '‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
            stopTimer();
        }

        function startTimer() {
            if (gameState.timer) clearInterval(gameState.timer);
            gameState.timer = setInterval(() => {
                gameState.timeLeft--;
                document.getElementById('timer').textContent = gameState.timeLeft;
                
                if (gameState.timeLeft <= 10) {
                    document.getElementById('timer').classList.add('text-red-400', 'animate-pulse');
                }
                
                if (gameState.timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
        }

        function stopTimer() {
            if (gameState.timer) {
                clearInterval(gameState.timer);
                gameState.timer = null;
            }
            document.getElementById('timer').classList.remove('text-red-400', 'animate-pulse');
        }

        function showNextWord() {
            if (gameState.currentWordIndex >= gameState.currentWords.length) {
                // –ï—Å–ª–∏ —Å–ª–æ–≤–∞ –∫–æ–Ω—á–∏–ª–∏—Å—å, –º–µ—à–∞–µ–º –∑–∞–Ω–æ–≤–æ
                gameState.currentWordIndex = 0;
                gameState.currentWords = shuffleArray(gameState.currentWords);
            }
            
            const wordData = gameState.currentWords[gameState.currentWordIndex];
            
            // –ê–Ω–∏–º–∞—Ü–∏—è —Å–º–µ–Ω—ã —Å–ª–æ–≤–∞
            const wordEl = document.getElementById('currentWord');
            wordEl.style.opacity = '0';
            setTimeout(() => {
                wordEl.textContent = wordData.word;
                document.getElementById('wordCategory').textContent = wordData.category;
                wordEl.style.opacity = '1';
            }, 150);
        }

        function guessWord() {
            if (!gameState.isPlaying) return;
            
            gameState.score++;
            gameState.guessed++;
            gameState.currentWordIndex++;
            
            document.getElementById('score').textContent = gameState.score;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è —Ñ–æ–Ω–∞ (–∑–µ–ª–µ–Ω–∞—è –≤—Å–ø—ã—à–∫–∞)
            const cardArea = document.getElementById('cardArea');
            cardArea.classList.remove('bg-white');
            cardArea.classList.add('bg-green-100');
            setTimeout(() => {
                cardArea.classList.remove('bg-green-100');
                cardArea.classList.add('bg-white');
            }, 200);
            
            showNextWord();
            
            // –í–∏–±—Ä–∞—Ü–∏—è (–∫–æ—Ä–æ—Ç–∫–∞—è)
            if (navigator.vibrate) navigator.vibrate(50);
        }

        function skipWord() {
            if (!gameState.isPlaying) return;
            
            gameState.score--;
            gameState.skipped++;
            gameState.currentWordIndex++;
            
            document.getElementById('score').textContent = gameState.score;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è —Ñ–æ–Ω–∞ (–∫—Ä–∞—Å–Ω–∞—è –≤—Å–ø—ã—à–∫–∞)
            const cardArea = document.getElementById('cardArea');
            cardArea.classList.remove('bg-white');
            cardArea.classList.add('bg-red-100');
            setTimeout(() => {
                cardArea.classList.remove('bg-red-100');
                cardArea.classList.add('bg-white');
            }, 200);
            
            showNextWord();
             
             // –í–∏–±—Ä–∞—Ü–∏—è (–¥–ª–∏–Ω–Ω–∞—è)
            if (navigator.vibrate) navigator.vibrate(200);
        }

        function endGame() {
            gameState.isPlaying = false;
            stopTimer();
            
            // –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            document.getElementById('finalScore').textContent = gameState.score;
            document.getElementById('guessedWords').textContent = gameState.guessed;
            document.getElementById('skippedWords').textContent = gameState.skipped;
            
            showScreen('resultsScreen');
            
            // –í–∏–±—Ä–∞—Ü–∏—è –ø–æ–±–µ–¥—ã
            if (navigator.vibrate) {
                navigator.vibrate([100, 50, 100, 50, 200]);
            }
        }

        function shareResults() {
            const text = `üó£Ô∏è –ò–≥—Ä–∞ Alias\nüèÜ –ú–æ–π —Å—á–µ—Ç: ${gameState.score}\n‚úÖ –£–≥–∞–¥–∞–Ω–æ: ${gameState.guessed}\n‚ùå –ü—Ä–æ–ø—É—â–µ–Ω–æ: ${gameState.skipped}\n\n–°–º–æ–∂–µ—à—å –ª—É—á—à–µ?`;
            
            if (tg && tg.sendData) {
                // –î–ª—è –±–æ—Ç–∞ (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∏–Ω—è—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö)
                tg.sendData(JSON.stringify({
                    action: 'share',
                    score: gameState.score,
                    guessed: gameState.guessed,
                    skipped: gameState.skipped
                }));
                // –ò –æ—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–∞—Ç–∏–≤–Ω—ã–π —à–µ—Ä–∏–Ω–≥
                tg.switchInlineQuery(text);
            } else if (navigator.share) {
                navigator.share({
                    title: 'Alias - –ú–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç',
                    text: text
                });
            } else {
                navigator.clipboard.writeText(text);
                if(tg) tg.showAlert('–¢–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
                else alert('–¢–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
            }
        }

        // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ Telegram
        if (tg) {
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ
            tg.BackButton.onClick(() => {
                const currentScreen = document.querySelector('.screen:not(.hidden)');
                if (currentScreen && currentScreen.id !== 'mainScreen') {
                    // –ï—Å–ª–∏ –∏–¥–µ—Ç –∏–≥—Ä–∞, —Å–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                    if (currentScreen.id === 'gameScreen' && gameState.isPlaying) {
                        tg.showConfirm("–ü—Ä–µ—Ä–≤–∞—Ç—å —Ä–∞—É–Ω–¥?", (ok) => {
                            if(ok) {
                                endGame();
                                showMain();
                            }
                        });
                    } else {
                        showMain();
                    }
                } else {
                    tg.close();
                }
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞–∑–∞–¥, –µ—Å–ª–∏ –º—ã –Ω–µ –Ω–∞ –≥–ª–∞–≤–Ω–æ–º
            setInterval(() => {
                const currentScreen = document.querySelector('.screen:not(.hidden)');
                if (currentScreen && currentScreen.id !== 'mainScreen') {
                    tg.BackButton.show();
                } else {
                    tg.BackButton.hide();
                }
            }, 200);
        }
    </script>
</body>
</html>
